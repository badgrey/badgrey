language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm i -g npm@5.7.1 # delete once 5.7.X is out of "pre-release"
  - npm ci             # faster, goes only from package-lock
# before_script:
#   - psql -c 'create database "boilermaker-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
   - npm run build-client # make the bundle
   - rm -rf node_modules # omit from the tarball, since we skip cleanup
 deploy:
   skip_cleanup: true # prevents travis from deleting the build
   provider: heroku
   app: badgrey # see README
   api_key:
     secure: "Q41teBmyBLY58wxwCJI6jxqJSL6Mz5ZjJskd0GdmGf4IjPf+B6elNMhiC/qkNx2Zg5Clc4XhMwfV7SjZNTn4w965/+Hfwm1FlfoalKcWzeuIZ5L58QTde1AxZKw7dJLYJrLX8UiCc4d/Po1NYqLcvZaREgBo3O46PSRGwzT6gfiDMNL7Lo/zbUmey1O1fJierVhV+43q1jKElZ9Cju3Z5sogdHFY0atV7vJRm2plppIahHSKXKaOk7sMRmOYAY2iJHKHDBPBPmENsvdLcbJTHVgA6jTMkAk+sR0hwjfMDavtsnqasIqGZyt8p82oQyXN5B/SgM/+xSYsYTIn+HOiG2+BlfuTHrFgWVu06kMlKkafWqEACsczaFoPoxfyev+wU+UgjsMObofIcfyzuqHrHX5FSpjn0b/IPmUlIRjf4YAqAJ6OlakvbQTlXZK+7UXLxtrmGf2LAqspG4EUK5L5+vUlnNq7NytY529njV8D3haUlsFNbwEi5G9PQ1Kr9NGvpYGKNxeBB1IGcXFsgHA5gGAtcXDM1EkKCCZ4RxG6jv8L1cv+7uDkpWZpmpasGpfdRfSfDjaSFqn0PvosdbJGsyw5hSgFb1jmtTbOhQUKiX//fZsa1agOChZfsMeBnEP33vQzAbtpjk/KAjEgX8hwH7+fqKh/6a/3OSf0Vd9/NRw=" # see README
